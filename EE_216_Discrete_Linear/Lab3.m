%***********************
%James Anderson
%Lab 3 Section E
%***********************
%---------------------------------------------------------------
%1
%---------------------------------------------------------------
T0 =4;
T = 0.05;

t=-T0:T:T0;

x = -(t+0.25).*((t+2>=0) - (t-1>=0));
y = 2*exp(-.4*(t+.5)).*cos(.5*pi*t-pi/4).*((t+.5>=0)-(t-2.5>=0));

z=T*conv(x,y);

z_new=z( ceil(length(z)/4) : ceil(3*length(z)/4.));


%---------------------------------------------------------------
%2
%---------------------------------------------------------------
Bounds=[8 6 4 2];
n=3;
T0=Bounds(n);
t=-T0:T:T0;
t_conv = -2*T0:T:2*T0;

x=exp(-.5*t).*(t>=0);
y= 2*exp(.75*t).*(-t>=0);
z_analytical = 1.6*exp(.75*t_conv).*(t_conv<0) +...
    1.6*exp(-.5*t_conv).*(t_conv>=0);

z_approx=T*conv(x,y);

figure;
plot(t_conv,z_analytical,'r',t_conv,z_approx,'b');

%---------------------------------------------------------------
%3
%---------------------------------------------------------------
T=.005;
T1=-2;
T2=3;
t=T1:T:T2;
t_conv = 2*T1:T:2*T2;

x = 3*( (((t-.875)/1.75 + .5)>=0) - (((t-.875)/1.75 - .5)>=0) );
y = 1.5*sin(4*pi*t);
z_analytical = -2.25/pi*cos(4*pi*t_conv);

z_approx=T*conv(x,y);

figure;
plot(t_conv,z_analytical, 'r',t_conv,z_approx,'b');

figure(3)
plot(t,x,'g',t,y,'b')
xlabel('Time(sec)');
ylabel('Amplitude');
legend('x(t)','y(t)')

%---------------------------------------------------------------
%4
%---------------------------------------------------------------
clear all
a = .3;
b = .4;
c = .8;
p = .9;
q = .2;

T = .005;
t = -1:T:12;
dirac_delta = (t==0)./T;

h(1) = 0;
h(2) = 0;
for n=3:size(t,2);
    h(n) = (h(n-1)*(b*T+2*a) - a*h(n-2) + ...
        dirac_delta(n)*(p*T^2+q*T)-...
        dirac_delta(n-1)*q*T)/(c*T^2+b*T+a);
end


t2=-12:T:12;

x=2-cos(.2*pi.*t2)+0.25*cos(2*pi.*t2);

h=[zeros(1,length(-12:T:(-1-T))) ,h];

y=T*conv(x,h);
t_conv=-24:T:24;

figure;
subplot(3,1,1)
plot(t2,h,'r');
subplot(3,1,2);
plot(t2,x,'g');
subplot(3,1,3);
plot(t_conv,y,'b')


%---------------------------------------------------------------
%5
%---------------------------------------------------------------

T


%---------------------------------------------------------------
%6
%---------------------------------------------------------------
